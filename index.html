<!DOCTYPE html>
<html>
<head>
    <title>Token Vulnerability Checker</title>
</head>
<body>
    <h1>Token Vulnerability Checker</h1>
    <p>Enter the address of the token you want to check:</p>
    <input type="text" id="tokenAddress">
    <button onclick="checkToken()">Check</button>
    <p id="result"></p>
    <p>Or, compile Solidity code using Remix:</p>
    <textarea id="solidityCode"></textarea>
    <button onclick="compileSolidity()">Compile</button>
    <p id="compileResult"></p>
    <script>
        async function checkToken() {
            const tokenAddress = document.getElementById("tokenAddress").value;
            const apiKey = "AFFD2SXUNV3RY968V4442KMBP4928IBMJ7"; // replace with your own Etherscan API key
            const etherscanEndpoint = `https://api.etherscan.io/api?module=contract&action=getsourcecode&address=${tokenAddress}&apikey=${apiKey}`;
            let response = await fetch(etherscanEndpoint);
            let result = "";
            if (response.ok) {
                let jsonResponse = await response.json();
                let contractCode = jsonResponse.result[0].SourceCode;
                if (contractCode === "") {
                    result = "Invalid token address";
                } else {
                    result = "Token contract code:\n" + contractCode;
                    const vulnerabilityAnalysisEndpoint = "https://api.etherscan.io/apisecurity/apikey?module=contract&action=checkcode&code=" + encodeURIComponent(contractCode);
                    let vulnerabilityResponse = await fetch(vulnerabilityAnalysisEndpoint);
                    if (vulnerabilityResponse.ok) {
                        let vulnerabilityJsonResponse = await vulnerabilityResponse.json();
                        if (vulnerabilityJsonResponse.result === "0") {
                            result += "\nNo vulnerabilities detected in the contract code";
                        } else {
                            result += "\nVulnerabilities detected in the contract code: " + vulnerabilityJsonResponse.result;
                        }
                    } else {
                        result += "\nError checking contract vulnerabilities";
                    }
                }
            } else {
                result = "Error checking token";
            }
            document.getElementById("result").innerText = result;
        }

        async function compileSolidity() {
            const solidityCode = document.getElementById("solidityCode").value;
            const remixEndpoint = "https://remix.ethereum.org/compile";
            let response = await fetch(remixEndpoint, {
                method: "POST",
                body: JSON.stringify({ "sources": { "file.sol": { "content": solidityCode } } }),
                headers: { "Content-Type": "application/json" }
            });
            let result = "";
            if (response.ok) {
                let jsonResponse = await response.json();
                let bytecode = jsonResponse.contracts["file.sol"]["contractName"].evm.bytecode.object;
                result = "Compiled bytecode:\n" + bytecode;
            } else {
                result = "Error compiling Solidity code";
            }
            document.getElementById("compileResult").innerText = result;
        }
    </script>
</body>
</html>
